<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Single-stage multi-arm clinical trials • multiarm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Single-stage multi-arm clinical trials">
<meta property="og:description" content="multiarm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiarm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/single_stage.html">Single-stage multi-arm clinical trials</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/mjg211/multiarm/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="single_stage_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Single-stage multi-arm clinical trials</h1>
                        <h4 class="author">Michael J. Grayling, Newcastle University (<a href="mailto:michael.grayling@newcastle.ac.uk" class="email">michael.grayling@newcastle.ac.uk</a>)</h4>
            
            <h4 class="date">13/10/2020</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/mjg211/multiarm/blob/master/vignettes/single_stage.Rmd"><code>vignettes/single_stage.Rmd</code></a></small>
      <div class="hidden name"><code>single_stage.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1. Introduction</h1>
<p><strong>multiarm</strong> provides functions to assist with the design of single- and multi-stage multi-arm clinical trials. This vignette describes the functionality available for single-stage designs. As will be discussed, the available functions allow for sample size determination, trial simulation, analytical operating characteristic calculation, and the production of several informative plots.</p>
<p>Note that an R Shiny graphical user interface is also available for designing single-stage trials; it can be accessed within R using <code><a href="../reference/gui.html">multiarm::gui()</a></code>, or online at <a href="https://mjgrayling.shinyapps.io/multiarm">https://mjgrayling.shinyapps.io/multiarm</a>. Additional information on this app can be found in <a href="https://doi.org/10.1186/s12885-020-6525-0">Grayling and Wason (2020)</a>.</p>
<p>This vignette will proceed by first precisely detailing the type of (single-stage) trial designs <strong>multiarm</strong> supports. Each of the available relevant functions will then be described, before several examples and useful further information is provided.</p>
</div>
<div id="single-stage-multi-arm-clinical-trials" class="section level1">
<h1 class="hasAnchor">
<a href="#single-stage-multi-arm-clinical-trials" class="anchor"></a>2. (Single-stage) multi-arm clinical trials</h1>
<div id="design-setting" class="section level2">
<h2 class="hasAnchor">
<a href="#design-setting" class="anchor"></a>2.1. Design setting</h2>
<p><strong>multiarm</strong> supports the design of single-stage multi-arm clinical trials that use a many-to-one design. That is, a design where a single shared control treatment arm is compared in a pairwise manner to some number of experimental treatment arms, following the accrual of outcome data from a specified number of patients on each arm.</p>
<p>More formally, it supposes that outcomes <span class="math inline">\(X_{ik}\)</span> will be accrued from patients <span class="math inline">\(i\in\{1,\dots,n_k\}\)</span> on treatment arms <span class="math inline">\(k\in\{0,\dots,K\}\)</span>. In Section 2.6, more information on the precise types of outcome that are currently supported is provided. Next, specifying that arm <span class="math inline">\(k=0\)</span> corresponds to the shared control arm, and arms <span class="math inline">\(k\in\{1,\dots,K\}\)</span> to the experimental arms, the hypotheses of interest are assumed to be: <span class="math display">\[ H_k\ :\ \tau_k \le 0,\ \ k\in\{1,\dots,K\}.\]</span> Here, <span class="math inline">\(\tau_k\)</span> corresponds to a treatment effect for experimental arm <span class="math inline">\(k\in\{1,\dots,K\}\)</span>, relative to the control arm. Thus, we test whether the treatment effects are negative, hoping that they will be positive (i.e., we assume positive <span class="math inline">\(\tau_k\)</span> corresponds to patient benefit). Later, for brevity, we will make use of the notation <span class="math inline">\(\boldsymbol{\tau}=(\tau_1,\dots,\tau_K)^\top\in\mathbb{R}^K\)</span>. We will also make reference to the global null hypothesis, <span class="math inline">\(H_G\)</span>, which we define to be the scenario with <span class="math inline">\(\tau_1=\cdots=\tau_K=0\)</span>.</p>
<p>To test hypothesis <span class="math inline">\(H_k\)</span>, we assume that a Wald test statistic, <span class="math inline">\(z_k\)</span>, is computed: <span class="math display">\[ z_k = \frac{\hat{\tau}_k}{\sqrt{\text{Var}(\hat{\tau}_k)}} = \hat{\tau}_kI_k^{1/2},\ \ k\in\{1,\dots,K\}. \]</span> In what follows, we will use the notation <span class="math inline">\(\boldsymbol{z}_k=(z_1,\dots,z_k)^\top\in\mathbb{R}^k\)</span>. Then, <strong>multiarm</strong> supports single-stage design in certain scenarios where <span class="math inline">\(\boldsymbol{Z}_k\)</span>, the random pre-trial value of <span class="math inline">\(\boldsymbol{z}_k\)</span>, has (at least asymptotically) a <span class="math inline">\(k\)</span>-dimensional multivariate normal (MVN) distribution, with: <span class="math display">\[\begin{align}
\mathbb{E}(Z_l) &amp;= \tau_lI_l^{1/2},\ l=1,\dots,k,\\
\text{Cov}(Z_{l},Z_{l}) &amp;= 1,\ l\in\{1,\dots,k\},\\
\text{Cov}(Z_{l_1},Z_{l_2}) &amp;= I_{l_1}^{1/2}I_{l_2}^{1/2}\text{Cov}(\tau_{l_1},\tau_{l_2}),\ l_1 \neq l_2,\ l_1,l_2\in\{1,\dots,k\}.
\end{align}\]</span> Ultimately, to test the hypotheses, <span class="math inline">\(\boldsymbol{z}_K\)</span> is converted to a vector of <span class="math inline">\(p\)</span>-values, <span class="math inline">\(\boldsymbol{p}=(p_1,\dots,p_K)^\top\in[0,1]^K\)</span>, via: <span class="math display">\[ p_k = 1 - \Phi_1(z_k,0,1),\ \ k\in\{1,\dots,K\}.\]</span> Here, <span class="math inline">\(\Phi_n\{(a_1,\dots,a_n)^\top,\boldsymbol{\lambda},\Sigma\}\)</span> is the cumulative distribution function of an <span class="math inline">\(n\)</span>-dimensional MVN distribution, with mean <span class="math inline">\(\boldsymbol{\lambda}\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>. Precisely: <span class="math display">\[ \Phi_n\{(a_1,\dots,a_n)^\top,\boldsymbol{\lambda},\Sigma\} = \int_{-\infty}^{a_1}\dots\int_{-\infty}^{a_n}\phi_n\{\boldsymbol{x},\boldsymbol{\lambda},\Sigma\}\mathrm{d}x_n\dots\mathrm{d}x_1, \]</span> where <span class="math inline">\(\phi_n\{\boldsymbol{x},\boldsymbol{\lambda},\Sigma\}\)</span> is the probability density function of an <span class="math inline">\(n\)</span>-dimensional MVN distribution with mean <span class="math inline">\(\boldsymbol{\lambda}\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>, evaluated at vector <span class="math inline">\(\boldsymbol{x}=(x_1,\dots,x_n)^\top\)</span>.</p>
<p>Finally, to determine whether to reject each null hypothesis, the <span class="math inline">\(p_k\)</span> are compared to a set of significance thresholds, which are specified based on a chosen MCC (see below), in combination with a nominated significance level <span class="math inline">\(\alpha\in(0,1)\)</span>.</p>
<p>With the above, the principal goal of <strong>multiarm</strong> is to provide a set of functions that:</p>
<ol style="list-style-type: lower-alpha">
<li>help choose the significance thresholds against which the <span class="math inline">\(p_k\)</span> are compared;</li>
<li>help make choices on appropriate values for the <span class="math inline">\(n_k\)</span>, <span class="math inline">\(k\in\{0,\dots,K\}\)</span>, to achieve some desired level of statistical power (see Section 2.3);</li>
<li>help evaluate the statistical characteristics of a chosen design.</li>
</ol>
<p>Before we describe the currently supported MCCs however, we will first describe the operating characteristics that can be evaluated by <strong>multiarm</strong>.</p>
</div>
<div id="operating-characteristics" class="section level2">
<h2 class="hasAnchor">
<a href="#operating-characteristics" class="anchor"></a>2.2. Operating characteristics</h2>
<p><strong>multiarm</strong> supports the evaluation of a wide selection of statistical operating characteristics that may be of interest when choosing a multi-arm trial design. To understand how these are mathematically calculated, it is useful to summarise the results of the trial, in terms of the outcome for each of the <span class="math inline">\(K\)</span> hypotheses, using a small table:</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">Reject</th>
<th align="right">Do not reject</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>True null</td>
<td align="right"><span class="math inline">\(A\)</span></td>
<td align="right"><span class="math inline">\(B\)</span></td>
</tr>
<tr class="even">
<td>False null</td>
<td align="right"><span class="math inline">\(C\)</span></td>
<td align="right"><span class="math inline">\(D\)</span></td>
</tr>
</tbody>
</table>
<p>With this, <strong>multiarm</strong> can compute the following quantities for any nominated multi-arm design scenario and set of treatment effects (that is, the quantities are conditional on specification of various design factors; we omit this conditioning for brevity):</p>
<ul>
<li><p><strong>The conjunctive power:</strong> The probability that all of the null hypotheses are rejected, irrespective of whether they are true or false: <span class="math display">\[ P_\text{con}(\boldsymbol{\tau}) = \mathbb{P}(A+C = K \mid \boldsymbol{\tau}).\]</span></p></li>
<li><p><strong>The disjunctive power:</strong> The probability that at least one of the null hypotheses is rejected, irrespective of whether they are true or false: <span class="math display">\[ P_\text{dis}(\boldsymbol{\tau}) = \mathbb{P}(A+C &gt; 0 \mid \boldsymbol{\tau}).\]</span></p></li>
<li><p><strong>The marginal power:</strong> For arm <span class="math inline">\(k\in\{1,\dots,K\}\)</span> is the probability that <span class="math inline">\(H_k\)</span> is rejected: <span class="math display">\[ P_k(\boldsymbol{\tau}) = \mathbb{P}(\text{Reject }H_k \mid \boldsymbol{\tau}).\]</span></p></li>
<li><p><strong>The per-hypothesis error-rate (PHER):</strong> The expected value of the number of type-I errors divided by the number of hypotheses: <span class="math display">\[ PHER(\boldsymbol{\tau}) = \frac{\mathbb{E}(A \mid \boldsymbol{\tau})}{K}.\]</span></p></li>
<li><p><strong>The <span class="math inline">\(a\)</span>-generalised type-I familywise error-rate:</strong> The probability that at least <span class="math inline">\(a\in\{1,\dots,K\}\)</span> type-I errors are made: <span class="math display">\[ FWER_{Ia}(\boldsymbol{\tau}) = \mathbb{P}(A \ge a \mid \boldsymbol{\tau}).\]</span> Note that <span class="math inline">\(FWER_{I1}\)</span> is the conventional familywise error-rate (<span class="math inline">\(FWER\)</span>); the probability of making at least one type-I error.</p></li>
<li><p><strong>The <span class="math inline">\(d\)</span>-generalised type-II familywise error-rate:</strong> The probability that at least <span class="math inline">\(d\in\{1,\dots,K\}\)</span> type-II errors are made: <span class="math display">\[ FWER_{IId}(\boldsymbol{\tau}) = \mathbb{P}(D \ge d \mid \boldsymbol{\tau}).\]</span></p></li>
<li><p><strong>The false discovery rate (<span class="math inline">\(FDR\)</span>):</strong> The expected proportion of type-I errors amongst the rejected hypotheses: <span class="math display">\[ FDR(\boldsymbol{\tau}) = \mathbb{E}\left\{\frac{A}{A+C} \mid A+C&gt;0,\boldsymbol{\tau}\right\}\mathbb{P}(A+C&gt;0 \mid \boldsymbol{\tau}). \]</span></p></li>
<li><p><strong>The false non-discovery rate (<span class="math inline">\(FNDR\)</span>):</strong> The expected proportion of type-II errors amongst the hypotheses that are not rejected: <span class="math display">\[ FNDR(\boldsymbol{\tau})= \mathbb{E}\left\{\frac{D}{B+D} \mid B+D&gt;0,\boldsymbol{\tau}\right\}\mathbb{P}(B+D&gt;0 \mid \boldsymbol{\tau}). \]</span></p></li>
<li><p><strong>The positive false discovery rate:</strong> The rate that rejections are type-I errors: <span class="math display">\[ pFDR(\boldsymbol{\tau}) = \mathbb{E}\left\{\frac{D}{B+D} \mid B+D&gt;0,\boldsymbol{\tau}\right\}. \]</span></p></li>
<li><p><strong>The sensitivity:</strong> The expected proportion of the number of correct rejections of the hypotheses to the number of false null hypotheses: <span class="math display">\[ Sensitivity(\boldsymbol{\tau}) = \mathbb{E}\left\{\frac{C}{C+D} \mid \boldsymbol{\tau}\right\}. \]</span></p></li>
<li><p><strong>The specificity:</strong> The expected proportion of the number of correctly not rejected hypotheses to the number of true null hypotheses: <span class="math display">\[ Specificity(\boldsymbol{\tau}) = \mathbb{E}\left\{\frac{B}{A+B} \mid \boldsymbol{\tau}\right\}. \]</span></p></li>
</ul>
</div>
<div id="multiple-comparison-corrections" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-comparison-corrections" class="anchor"></a>2.3. Multiple comparison corrections</h2>
</div>
<div id="per-hypothesis-error-rate-control" class="section level2">
<h2 class="hasAnchor">
<a href="#per-hypothesis-error-rate-control" class="anchor"></a>2.3.1 Per-hypothesis error-rate control</h2>
<p>The most simple possible solution for selecting the significance thresholds against which to compare the <span class="math inline">\(p_k\)</span>, is to compare each to the chosen significance level <span class="math inline">\(\alpha\)</span>. That is, to reject <span class="math inline">\(H_k\)</span> for <span class="math inline">\(k\in\{1,\dots,K\}\)</span> if <span class="math inline">\(p_k \le \alpha\)</span>. This controls the PHER to <span class="math inline">\(\alpha\)</span>, and corresponds to not utilising a so-called MCC. In <strong>multiarm</strong>, this approach can be chosen by setting <code>correction = "none"</code>.</p>
<p>A potential problem with this, however, can be that the statistical operating characteristics of the resulting design may not be desirable (e.g., in terms of <span class="math inline">\(FWER_{I1}\)</span>). For this reason, in general one may wish to make use of a MCC. Currently, <strong>multiarm</strong> supports the use of a variety of such MCCs, which aim to control either:</p>
<ol style="list-style-type: lower-alpha">
<li>the conventional FWER, <span class="math inline">\(FWER_{I1}\)</span> (with these techniques sub-divided into single-step, step-down, and step-up procedures) or;</li>
<li>the FDR.</li>
</ol>
<div id="single-step-family-wise-error-rate-control" class="section level3">
<h3 class="hasAnchor">
<a href="#single-step-family-wise-error-rate-control" class="anchor"></a>2.3.2. Single-step family-wise error-rate control</h3>
<p>These procedures test each of the <span class="math inline">\(H_k\)</span> against a common significance level, <span class="math inline">\(\gamma\in(0,1)\)</span> say, rejecting <span class="math inline">\(H_k\)</span> if <span class="math inline">\(p_k \le \gamma\)</span>. The currently supported single-step procedures are:</p>
<ul>
<li>
<strong>Bonferroni’s correction:</strong> This sets <span class="math inline">\(\gamma = \alpha/K\)</span>. It can be chosen by setting <code>correction = "bonferroni"</code>.</li>
<li>
<strong>Sidak’s correction:</strong> This sets <span class="math inline">\(\gamma = 1 - (1 - \alpha)^{1/K}\)</span>. It can be chosen by setting <code>correction = "sidak"</code>.</li>
<li>
<strong>Dunnett’s correction:</strong> This sets <span class="math inline">\(\gamma = 1 - \Phi_1\{z_D,0,1\}\)</span>, where <span class="math inline">\(z_\text{D}\)</span> is the solution of the following equation <span class="math display">\[ \alpha = 1 - \Phi_K\{(z_D,\dots,z_D)^\top,\boldsymbol{0}_K,\text{Cov}(\boldsymbol{Z}_K)\}, \]</span> with <span class="math inline">\(\boldsymbol{0}_n=(0,\dots,0)^\top\in\mathbb{R}^n\)</span> an <span class="math inline">\(n\)</span>-dimensional vector of zeroes. It can be chosen by setting <code>correction = "dunnett"</code>.</li>
</ul>
<p>Note that each of the above specify a <span class="math inline">\(\gamma\)</span> such that the maximum probability of incorrectly rejecting at least one of the null hypotheses <span class="math inline">\(H_k\)</span>, <span class="math inline">\(k\in\{1,\dots,K\}\)</span>, over all possible values of <span class="math inline">\(\boldsymbol{\tau}\in\mathbb{R}^K\)</span> is at most <span class="math inline">\(\alpha\)</span>. This is referred to as <em>strong control</em> of <span class="math inline">\(FWER_{I1}\)</span>.</p>
</div>
<div id="step-down-family-wise-error-rate-control" class="section level3">
<h3 class="hasAnchor">
<a href="#step-down-family-wise-error-rate-control" class="anchor"></a>2.3.3. Step-down family-wise error-rate control</h3>
<p>These procedures work by first ranking the <span class="math inline">\(p\)</span>-values from smallest to largest. We will refer to these ranked <span class="math inline">\(p\)</span>-values by <span class="math inline">\(p_{(1)},\dots,p_{(K)}\)</span>, with associated hypotheses <span class="math inline">\(H_{(1)},\dots,H_{(K)}\)</span>. The <span class="math inline">\(p_{(k)}\)</span> are compared to a vector of significance levels <span class="math inline">\(\boldsymbol{\gamma}=(\gamma_1,\dots,\gamma_K)\in(0,1)^K\)</span>. Precisely, the maximal index <span class="math inline">\(k\)</span> such that <span class="math inline">\(p_{(k)}&gt;\gamma_k\)</span> is identified, and then <span class="math inline">\(H_{(1)},\dots,H_{(k-1)}\)</span> are rejected and <span class="math inline">\(H_{(k)},\dots,H_{(K)}\)</span> are not rejected. If <span class="math inline">\(k=1\)</span> then we do not reject any of the null hypotheses, and if no such <span class="math inline">\(k\)</span> exists then we reject all of the null hypotheses. The currently supported step-down procedures are:</p>
<ul>
<li>
<strong>Holm-Bonferroni correction:</strong> This sets <span class="math inline">\(\gamma_k=\alpha/(K+1-k)\)</span>. It can be chosen by setting <code>correction = "holm_bonferroni"</code>.</li>
<li>
<strong>Holm-Sidak correction:</strong> This sets <span class="math inline">\(\gamma_k = 1 - (1 - \alpha)^{1/(K+1-k)}\)</span>. It can be chosen by setting <code>correction = "holm_sidak"</code>.</li>
<li>
<strong>Step-down Dunnett correction:</strong> This can only currently be used when the <span class="math inline">\(Cov(Z_{k_1},Z_{k_2})\)</span> are equal for all <span class="math inline">\(k_1\neq k_2,\ k_1,k_2\in\{1,\dots,K\}\)</span>. In this case, it sets <span class="math inline">\(\gamma_k = 1 - \Phi\{z_{Dk}\}\)</span>, where <span class="math inline">\(z_{Dk}\)</span> is the solution to <span class="math display">\[ \alpha = 1 - \Phi_{K+1-k}\{(z_{Dk},\dots,z_{Dk})^\top,\boldsymbol{0}_{K+1-k},\text{Cov}(\boldsymbol{Z}_{K+1-k})\}. \]</span> It can be chosen by setting <code>correction = "step_down_dunnett"</code>.</li>
</ul>
<p>Note that each of the above methods provide strong control of <span class="math inline">\(FWER_{I1}\)</span>.</p>
</div>
<div id="step-up-family-wise-error-rate-control" class="section level3">
<h3 class="hasAnchor">
<a href="#step-up-family-wise-error-rate-control" class="anchor"></a>2.3.4. Step-up family-wise error-rate control</h3>
<p>These procedures also work by first ranking the <span class="math inline">\(p\)</span>-values from smallest to largest, and utilise a vector of significance levels <span class="math inline">\(\boldsymbol{\gamma}\)</span>. However, here, the largest <span class="math inline">\(k\)</span> such that <span class="math inline">\(p_{(k)} \le \gamma_k\)</span> is identified. Then, we reject the hypotheses <span class="math inline">\(H_{(1)},\dots,H_{(k)}\)</span>, and do not reject <span class="math inline">\(H_{(k+1)},\dots,H_{(K)}\)</span>. Currently, one such method is supported:</p>
<ul>
<li>
<strong>Hochberg’s correction:</strong> This sets <span class="math inline">\(\gamma_k=\alpha/(K+1-k)\)</span>. It can be chosen by setting <code>correction = "hochberg"</code>.</li>
</ul>
<p>This method also provides strong control of <span class="math inline">\(FWER_{I1}\)</span>.</p>
</div>
<div id="false-discovery-rate-control" class="section level3">
<h3 class="hasAnchor">
<a href="#false-discovery-rate-control" class="anchor"></a>2.3.5. False discovery rate control</h3>
<p>Whilst (most of) the above methods control <span class="math inline">\(FWER_{I1}\)</span> in the strong sense, it may be of interest instead to control the FDR. Currently, two methods that will control the FDR to at most <span class="math inline">\(\alpha\)</span> over all possible <span class="math inline">\(\boldsymbol{\tau}\in\mathbb{R}^K\)</span> are supported. They function in the same way as the step-up FWER control MCCs discussed above, but with:</p>
<ul>
<li>
<strong>Benjamini-Hochberg correction:</strong> This sets <span class="math inline">\(\gamma_k=k\alpha/K\)</span>. It can be chosen by setting <code>correction = "benjamini_hochberg"</code>.</li>
<li>
<strong>Benjamini-Yekutieli correction:</strong> This sets: <span class="math display">\[\gamma_k=\frac{k\alpha}{K\left(1 + \frac{1}{2} + \dots + \frac{1}{K}\right)}.\]</span> It can be chosen by setting <code>correction = "benjamini_yekutieli"</code>.</li>
</ul>
</div>
</div>
<div id="sample-size-determination" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-size-determination" class="anchor"></a>2.4. Sample size determination</h2>
<p>Powering a multi-arm trial is complex. Consequently, <strong>multiarm</strong> supports design determination for a variety of types of power. It requires values for <em>interesting</em> and <em>uninteresting</em> treatment effects to be specified, <span class="math inline">\(\delta_1\in\mathbb{R}^+\)</span> and <span class="math inline">\(\delta_0\in(-\infty,\delta_1)\)</span> respectively. With this, the following definitions are used:</p>
<ul>
<li>The <em>global alternative hypothesis</em>, <span class="math inline">\(H_A\)</span>, is given by: <span class="math display">\[\tau_1=\cdots=\tau_K=\delta_1.\]</span>
</li>
<li>The <em>least favourable configuration</em> for experimental arm <span class="math inline">\(k=1,\dots,K\)</span>, <span class="math inline">\(LFC_k\)</span>, is given by: <span class="math display">\[\tau_k=\delta_1,\ \tau_1=\cdots=\tau_{k-1}=\tau_{k+1}=\cdots=\tau_K=\delta_0.\]</span> For brevity, we will refer to the <span class="math inline">\(\boldsymbol{\tau}\)</span> implied by <span class="math inline">\(LFC_k\)</span> as <span class="math inline">\(\boldsymbol{\tau} = \boldsymbol{\theta}_k\)</span>.</li>
</ul>
<p>Then, the sample size required by a design to control the following types of power to a specified level <span class="math inline">\(1-\beta\)</span> can be determined (chosen using the arguments <code>beta</code> and <code>power</code>):</p>
<ul>
<li>
<strong>Conjunctive power under the global alternative hypothesis:</strong> Ensure that <span class="math inline">\(P_\text{con}\{(\delta_1,\dots,\delta_1)^\top\} \ge 1 - \beta\)</span>. It can be chosen by setting <code>power = "conjunctive"</code>.</li>
<li>
<strong>Disjunctive power under the global alternative hypothesis:</strong> Ensure that <span class="math inline">\(P_\text{dis}\{(\delta_1,\dots,\delta_1)^\top\} \ge 1 - \beta\)</span>. It can be chosen by setting <code>power = "disjunctive"</code>.</li>
<li>
<strong>Minimum marginal power under the least favourable configurations:</strong> Ensure that <span class="math inline">\(\min_{k\in\{1,\dots,K\}}P_k(\boldsymbol{\theta}_k) \ge 1 - \beta\)</span>. It can be chosen by setting <code>power = "marginal"</code>.</li>
</ul>
</div>
<div id="allocation-ratios" class="section level2">
<h2 class="hasAnchor">
<a href="#allocation-ratios" class="anchor"></a>2.5. Allocation ratios</h2>
<p>One of the primary goals of <strong>multiarm</strong> is to aid the choice of <span class="math inline">\(\boldsymbol{n}=(n_0,\dots,n_K)\)</span>. Currently, <strong>multiarm</strong> supports the determination of <span class="math inline">\(\boldsymbol{n}\)</span> by identifying a suitable <span class="math inline">\(n_0\)</span>, and then setting <span class="math inline">\(n_k=r_kn_0\)</span> for <span class="math inline">\(k\in\{1,\dots,K\}\)</span>, with <span class="math inline">\(\boldsymbol{r}=(r_1,\dots,r_K)\in(0,\infty)^K\)</span>.</p>
<p>In turn, it allows <span class="math inline">\(\boldsymbol{r}\)</span> to be specified (via the argument <code>ratio</code>) in a variety of ways. It can be specified explicitly as a numeric vector, or alternatively can be determined in an optimal manner. Currently, <strong>multiarm</strong> supports the determination of <span class="math inline">\(\boldsymbol{r}\)</span> for the following optimality criteria:</p>
<ul>
<li>
<strong><span class="math inline">\(A\)</span>-optimality:</strong> Minimizes the trace of the inverse of the information matrix of the design. This results in the minimization of the average variance of the treatment effect estimates.</li>
<li>
<strong><span class="math inline">\(D\)</span>-optimality:</strong> Maximizes the determinant of the information matrix of the design. This results in the minimization of the volume of the confidence ellipsoid for the treatment effect estimates.</li>
<li>
<strong><span class="math inline">\(E\)</span>-optimality:</strong> Maximizes the minimum eigenvalue of the information matrix. This results in the minimization of the maximum variance of the treatment effect estimates.</li>
</ul>
<p>The optimal allocation ratios are identified in the app using available closed-form solutions were possible, otherwise non-linear programming is employed.</p>
</div>
<div id="supported-outcome-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-outcome-variables" class="anchor"></a>2.6. Supported outcome variables</h2>
<div id="normally-distributed-outcome-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#normally-distributed-outcome-variables" class="anchor"></a>2.6.1. Normally distributed outcome variables</h3>
<p>Currently, <strong>multiarm</strong> supports multi-arm trial design for scenarios in which the outcome variables are assumed to be either normally or Bernoulli distributed.</p>
<p>Precisely, for the normal case, it assumes that <span class="math inline">\(X_{ik}\sim N(\mu_k,\sigma_k^2)\)</span>, and that <span class="math inline">\(\sigma_k^2\)</span> is known for <span class="math inline">\(k\in\{0,\dots,K\}\)</span>. Then, for each <span class="math inline">\(k\in\{1,\dots,K\}\)</span>:</p>
<p><span class="math display">\[\begin{align}
\tau_k &amp;= \mu_k-\mu_0,\\
\hat{\tau}_k &amp;= \frac{1}{n_k}\sum_{l=1}^{n_k}x_{ik} - \frac{1}{n_0}\sum_{l=1}^{n_0}x_{i0},\\
I_{k} &amp;= \frac{1}{\frac{\sigma_0^2}{n_0} +
\frac{\sigma_k^2}{n_k}}.
\end{align}\]</span></p>
<p>Furthermore, <span class="math inline">\(\boldsymbol{Z}_K\)</span> has a multivariate normal distribution, and thus the operating characteristics can be computed exactly using multivariate normal integration. Additionally, the distribution of <span class="math inline">\(\boldsymbol{Z}_K\)</span> does not depend upon the values of the <span class="math inline">\(\mu_k\)</span>, <span class="math inline">\(k\in\{0,\dots,K\}\)</span>. Consequently, these parameters play no part in the inputs or outputs of functions in <strong>multiarm</strong>. In contrast, where relevant, the functions within <strong>multiarm</strong> request values for the <span class="math inline">\(\sigma_k\)</span> via the argument <code>sigma</code>.</p>
<p>Functions with names ending in <code>_ss_norm</code> support single-stage designs in which the outcome variables are assumed to be normally distributed.</p>
</div>
<div id="bernoulli-distributed-outcome-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#bernoulli-distributed-outcome-variables" class="anchor"></a>2.6.2. Bernoulli distributed outcome variables</h3>
<p>In this case, <span class="math inline">\(X_{ik}\sim Bern(\pi_k)\)</span> for response rates <span class="math inline">\(\pi_k\)</span>, and for each <span class="math inline">\(k\in\{1,\dots,K\}\)</span>:</p>
<p><span class="math display">\[\begin{align}
\tau_k &amp;= \pi_k-\pi_0,\\
\hat{\tau}_k &amp;= \frac{1}{n_k}\sum_{l=1}^{n_k}x_{ik} - \frac{1}{n_0}\sum_{l=1}^{n_0}x_{i0},\\
I_{k} &amp;= \frac{1}{\frac{\pi_0(1 - \pi_0)}{n_0} +
\frac{\pi_k(1 - \pi_k)}{n_k}}.
\end{align}\]</span></p>
<p>Thus, a problem for design determination becomes that the information levels are dependent on the unknown response rates. In practice, this is handled by setting:</p>
<p><span class="math display">\[ I_k = \frac{1}{\frac{\hat{\pi}_0(1 - \hat{\pi}_0)}{n_0} +
\frac{\hat{\pi}_k(1 - \hat{\pi}_k)}{n_k}},\]</span> for <span class="math inline">\(\hat{\pi}_k = \sum_{l=1}^{n_k}x_{ik}/n_k\)</span>, <span class="math inline">\(k\in\{0,\dots,K\}\)</span>. This is the assumption made where relevant in <strong>multiarm</strong>. With this, <span class="math inline">\(\boldsymbol{Z}_K\)</span> is only asymptotically multivariate normal. Thus, in general it is important to validate operating characteristics evaluated using multivariate normal integration via simulation.</p>
<p>In addition, note that the above problem also means that the operating characterstics under <span class="math inline">\(HG\)</span>, <span class="math inline">\(HA\)</span>, and the <span class="math inline">\(LFC_k\)</span> are not unique without further restriction. Thus, to achieve uniqueness, <strong>multiarm</strong> requires a value be specified for <span class="math inline">\(\pi_0\)</span> (<code>pi0</code>) for use in the definition of these scenarios. And for this reason, the inputs and outputs of functions supporting Bernoulli outcomes make no reference to the <span class="math inline">\(\tau_k\)</span>, and work instead directly in terms of the <span class="math inline">\(\pi_k\)</span>. Finally, it also means that to determine <span class="math inline">\(A\)</span>-, <span class="math inline">\(D\)</span>-, or <span class="math inline">\(E\)</span>-optimised allocation ratios, a specific set of values for for the <span class="math inline">\(\pi_k\)</span> must be assumed (see <code>ratio_scenario</code> in <code><a href="../reference/des_ss_bern.html">des_ss_bern()</a></code>).</p>
<p>In this case, we should also ensure that <span class="math inline">\(\delta_1\in(0,1)\)</span> and <span class="math inline">\(\delta_0\in(-\pi_0,\delta_1)\)</span>, for the assumed value of <span class="math inline">\(\pi_0\)</span>, since <span class="math inline">\(\pi_k\in[0,1]\)</span> for <span class="math inline">\(k\in\{1,\dots,K\}\)</span>.</p>
<p>Functions with names ending in <code>_ss_bern</code> support single-stage designs in which the outcome variables are assumed to be Bernoulli distributed.</p>
</div>
</div>
</div>
<div id="functions" class="section level1">
<h1 class="hasAnchor">
<a href="#functions" class="anchor"></a>3. Functions</h1>
<div id="des_ss_bern-and-des_ss_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#des_ss_bern-and-des_ss_norm" class="anchor"></a>3.1. <code>des_ss_bern()</code> and <code>des_ss_norm()</code>
</h2>
<p><code><a href="../reference/des_ss_bern.html">des_ss_bern()</a></code> and <code><a href="../reference/des_ss_norm.html">des_ss_norm()</a></code> are amongs the primary functions within <strong>multiarm</strong>. They are used to determine single-stage multi-arm clinical trial designs attaining a desired level of a specified type of power, for normally and Bernoulli distributed outcomes respectively.</p>
</div>
<div id="build_ss_bern-and-build_ss_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#build_ss_bern-and-build_ss_norm" class="anchor"></a>3.3. <code>build_ss_bern()</code> and <code>build_ss_norm()</code>
</h2>
<p><code><a href="../reference/des_ss_bern.html">des_ss_bern()</a></code> and <code><a href="../reference/des_ss_norm.html">des_ss_norm()</a></code> search for designs based upon the chosen input parameters. However, in certain circumstances there may be a specific design that is of interest. <code><a href="../reference/build_ss_bern.html">build_ss_bern()</a></code> and <code><a href="../reference/build_ss_norm.html">build_ss_norm()</a></code> can be used to construct such designs, specifically for subsequent use with the other functions available in <strong>multiarm</strong>.</p>
</div>
<div id="plot-multiarm_des_ss_bern-and-plot-multiarm_des_ss_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-multiarm_des_ss_bern-and-plot-multiarm_des_ss_norm" class="anchor"></a>3.4. <code>plot.multiarm_des_ss_bern()</code> and <code>plot.multiarm_des_ss_norm()</code>
</h2>
<p><strong>multiarm</strong> can produce a variety of plots for the outputs from <code><a href="../reference/build_ss_bern.html">build_ss_bern()</a></code>, <code><a href="../reference/build_ss_norm.html">build_ss_norm()</a></code>, <code><a href="../reference/des_ss_bern.html">des_ss_bern()</a></code>, and <code><a href="../reference/des_ss_norm.html">des_ss_norm()</a></code> via the S3 functions <code><a href="../reference/plot.multiarm_des_ss_bern.html">plot.multiarm_des_ss_bern()</a></code> and <code><a href="../reference/plot.multiarm_des_ss_norm.html">plot.multiarm_des_ss_norm()</a></code>.</p>
</div>
<div id="opchar_ss_bern-and-opchar_ss_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#opchar_ss_bern-and-opchar_ss_norm" class="anchor"></a>3.5. <code>opchar_ss_bern()</code> and <code>opchar_ss_norm()</code>
</h2>
<p>Whilst <code><a href="../reference/build_ss_bern.html">build_ss_bern()</a></code>, <code><a href="../reference/build_ss_norm.html">build_ss_norm()</a></code>, <code><a href="../reference/des_ss_bern.html">des_ss_bern()</a></code>, and <code><a href="../reference/des_ss_norm.html">des_ss_norm()</a></code> return a small summary of the statistical operating characteristics of a design, it may occasionally be of interest to evaluate the operating characteristics of a design in a wider range of settings. <code><a href="../reference/opchar_ss_bern.html">opchar_ss_bern()</a></code> and <code><a href="../reference/opchar_ss_norm.html">opchar_ss_norm()</a></code> are designed for this purpose.</p>
</div>
<div id="sim_ss_bern-and-sim_ss_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#sim_ss_bern-and-sim_ss_norm" class="anchor"></a>3.6. <code>sim_ss_bern()</code> and <code>sim_ss_norm()</code>
</h2>
<p>Each of the functions above rely upon multivariate normal integration for operating characteristic evaluation. In certain circumstances, most likely when either (a) <span class="math inline">\(K\)</span> is large or (b) analytical evaluations need to be validated, recourse to simulation is useful. <code><a href="../reference/sim_ss_bern.html">sim_ss_bern()</a></code> and <code><a href="../reference/sim_ss_norm.html">sim_ss_norm()</a></code> are designed to be helpful in these settings.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>4. Examples</h1>
<div id="example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1" class="anchor"></a>4.1. Example 1</h2>
<p>We demonstrate the basic functionality provided in <strong>multiarm</strong>. First, identify a design using <code><a href="../reference/des_ss_norm.html">des_ss_norm()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://github.com/mjg211/multiarm">multiarm</a></span>)
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt; multiarm: Design of single- and multi-stage multi-arm clinical trials</span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; v.0.11: For an overview of the package's functionality enter: ?multiarm</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For news on the latest updates enter: news(package = "multiarm")</span>
<span class="kw">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_ss_norm.html">des_ss_norm</a></span>(integer = <span class="fl">TRUE</span>)
</pre></div>
<p>Note that the argument <code>integer</code> has been used because we will make a call to <code><a href="../reference/sim_ss_norm.html">sim_ss_norm()</a></code> later on.</p>
<p>We can then plot power curves with <code><a href="../reference/plot.multiarm_des_ss_norm.html">plot.multiarm_des_ss_norm()</a></code> as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">des</span>)
</pre></div>
<p><img src="single_stage_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="single_stage_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<pre><code>#&gt; Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
#&gt; Using compatibility `.name_repair`.
#&gt; This warning is displayed once every 8 hours.
#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<p><img src="single_stage_files/figure-html/unnamed-chunk-2-3.png" width="700"><img src="single_stage_files/figure-html/unnamed-chunk-2-4.png" width="700"></p>
<p><code><a href="../reference/des_ss_norm.html">des_ss_norm()</a></code> contains a summary of the operating characteristics of the identified design:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">des</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 4 x 16</span>
<span class="co">#&gt;    tau1  tau2   Pdis    Pcon     P1     P2 FWERI1  FWERI2 FWERII1 FWERII2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0     0   0.0250 0.00196 0.0135 0.0135 0.0250 0.00196  0       0     </span>
<span class="co">#&gt; 2   0.5   0.5 0.968  0.834   0.901  0.901  0      0        0.166   0.0319</span>
<span class="co">#&gt; 3   0.5   0   0.901  0.0135  0.901  0.0135 0.0135 0        0.0989  0     </span>
<span class="co">#&gt; 4   0     0.5 0.901  0.0135  0.0135 0.901  0.0135 0        0.0989  0     </span>
<span class="co">#&gt; # … with 6 more variables: PHER &lt;dbl&gt;, FDR &lt;dbl&gt;, pFDR &lt;dbl&gt;, FNDR &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Sens &lt;dbl&gt;, Spec &lt;dbl&gt;</span>
</pre></div>
<p>We can validate these using <code><a href="../reference/sim_ss_norm.html">sim_ss_norm()</a></code> with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="../reference/sim_ss_norm.html">sim_ss_norm</a></span>(<span class="kw">des</span>)<span class="op">$</span><span class="kw">sim</span>
<span class="co">#&gt; # A tibble: 4 x 16</span>
<span class="co">#&gt;    tau1  tau2   Pdis    Pcon     P1     P2 FWERI1  FWERI2 FWERII1 FWERII2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0     0   0.0252 0.00194 0.0136 0.0136 0.0252 0.00194  0       0     </span>
<span class="co">#&gt; 2   0.5   0.5 0.969  0.833   0.901  0.902  0      0        0.167   0.0310</span>
<span class="co">#&gt; 3   0.5   0   0.901  0.0137  0.901  0.0137 0.0137 0        0.0987  0     </span>
<span class="co">#&gt; 4   0     0.5 0.900  0.0127  0.0127 0.900  0.0127 0        0.0998  0     </span>
<span class="co">#&gt; # … with 6 more variables: PHER &lt;dbl&gt;, FDR &lt;dbl&gt;, pFDR &lt;dbl&gt;, FNDR &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Sens &lt;dbl&gt;, Spec &lt;dbl&gt;</span>
</pre></div>
</div>
<div id="example-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2" class="anchor"></a>4.2. Example 2</h2>
<p>Now, lets make use of some of the additional functionality from <strong>multiarm</strong>.</p>
<p>First, let’s find a design for a scenario with <span class="math inline">\(K=3\)</span>, using the Holm-Bonferroni correction, desiring to control the disjunctive power, choosing the allocation ratios for <span class="math inline">\(D\)</span>-optimality, in a scenario where the standard deviations differ across the arms:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_ss_norm.html">des_ss_norm</a></span>(K          = <span class="fl">3</span>,
                   sigma      = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span>),
                   ratio      = <span class="st">"D"</span>,
                   correction = <span class="st">"holm_bonferroni"</span>,
                   power      = <span class="st">"disjunctive"</span>,
                   integer    = <span class="fl">TRUE</span>)
</pre></div>
<p>Thus the total required sample size by the design is:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">des</span><span class="op">$</span><span class="kw">N</span>
<span class="co">#&gt; [1] 230</span>
</pre></div>
<p>And, the allocation ratios are:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">des</span><span class="op">$</span><span class="kw">ratio</span>
<span class="co">#&gt; [1] 1.705882 1.970588 2.088235</span>
</pre></div>
<p>Next, note that the operating characeristics of the truly optimal design are:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">des</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 5 x 20</span>
<span class="co">#&gt;    tau1  tau2  tau3   Pdis    Pcon      P1      P2      P3 FWERI1  FWERI2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0     0     0   0.0243 9.65e-5 0.00856 0.00854 0.00852 0.0243 1.22e-3</span>
<span class="co">#&gt; 2   0.5   0.5   0.5 0.901  3.32e-1 0.822   0.614   0.449   0      0.     </span>
<span class="co">#&gt; 3   0.5   0     0   0.788  9.67e-4 0.787   0.0124  0.0124  0.0238 9.71e-4</span>
<span class="co">#&gt; 4   0     0.5   0   0.535  1.03e-3 0.0117  0.532   0.0114  0.0221 1.07e-3</span>
<span class="co">#&gt; 5   0     0     0.5 0.348  9.96e-4 0.0108  0.0106  0.341   0.0203 1.12e-3</span>
<span class="co">#&gt; # … with 10 more variables: FWERI3 &lt;dbl&gt;, FWERII1 &lt;dbl&gt;, FWERII2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FWERII3 &lt;dbl&gt;, PHER &lt;dbl&gt;, FDR &lt;dbl&gt;, pFDR &lt;dbl&gt;, FNDR &lt;dbl&gt;, Sens &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Spec &lt;dbl&gt;</span>
</pre></div>
<p>We can validate these with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="../reference/sim_ss_norm.html">sim_ss_norm</a></span>(<span class="kw">des</span>)<span class="op">$</span><span class="kw">sim</span>
<span class="co">#&gt; # A tibble: 5 x 20</span>
<span class="co">#&gt;    tau1  tau2  tau3   Pdis    Pcon      P1      P2      P3 FWERI1  FWERI2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0     0     0   0.0245 0.00011 0.00825 0.00864 0.00869 0.0245 0.00101</span>
<span class="co">#&gt; 2   0.5   0.5   0.5 0.901  0.331   0.820   0.613   0.448   0      0      </span>
<span class="co">#&gt; 3   0.5   0     0   0.790  0.00109 0.788   0.0128  0.0129  0.0246 0.00109</span>
<span class="co">#&gt; 4   0     0.5   0   0.535  0.00094 0.0115  0.531   0.0116  0.0221 0.00097</span>
<span class="co">#&gt; 5   0     0     0.5 0.345  0.00095 0.0104  0.0100  0.339   0.0194 0.00109</span>
<span class="co">#&gt; # … with 10 more variables: FWERI3 &lt;dbl&gt;, FWERII1 &lt;dbl&gt;, FWERII2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FWERII3 &lt;dbl&gt;, PHER &lt;dbl&gt;, FDR &lt;dbl&gt;, pFDR &lt;dbl&gt;, FNDR &lt;dbl&gt;, Sens &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Spec &lt;dbl&gt;</span>
</pre></div>
<p>Or recreate them with <code><a href="../reference/opchar_ss_norm.html">opchar_ss_norm()</a></code> via:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="../reference/opchar_ss_norm.html">opchar_ss_norm</a></span>(<span class="kw">des</span>)<span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 5 x 20</span>
<span class="co">#&gt;    tau1  tau2  tau3   Pdis    Pcon      P1      P2      P3 FWERI1  FWERI2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0     0     0   0.0243 9.64e-5 0.00856 0.00854 0.00852 0.0243 1.22e-3</span>
<span class="co">#&gt; 2   0.5   0.5   0.5 0.902  3.32e-1 0.822   0.614   0.449   0      0.     </span>
<span class="co">#&gt; 3   0.5   0     0   0.788  9.67e-4 0.787   0.0124  0.0124  0.0238 9.71e-4</span>
<span class="co">#&gt; 4   0     0.5   0   0.535  1.03e-3 0.0117  0.532   0.0114  0.0221 1.07e-3</span>
<span class="co">#&gt; 5   0     0     0.5 0.348  9.96e-4 0.0108  0.0106  0.341   0.0203 1.12e-3</span>
<span class="co">#&gt; # … with 10 more variables: FWERI3 &lt;dbl&gt;, FWERII1 &lt;dbl&gt;, FWERII2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FWERII3 &lt;dbl&gt;, PHER &lt;dbl&gt;, FDR &lt;dbl&gt;, pFDR &lt;dbl&gt;, FNDR &lt;dbl&gt;, Sens &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Spec &lt;dbl&gt;</span>
</pre></div>
<p>And, as earlier, we can produce power-curve plots with:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">des</span>)
</pre></div>
<p><img src="single_stage_files/figure-html/unnamed-chunk-11-1.png" width="700"><img src="single_stage_files/figure-html/unnamed-chunk-11-2.png" width="700"><img src="single_stage_files/figure-html/unnamed-chunk-11-3.png" width="700"><img src="single_stage_files/figure-html/unnamed-chunk-11-4.png" width="700"></p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Grayling MJ, Wason JMS (2020) A web application for the design of multi-arm clinical trials. <em>BMC Cancer</em> 20:80. DOI: <a href="https://doi.org/10.1186/s12885-020-6525-0">10.1186/s12885-020-6525-0</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32005187">32005187</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael J Grayling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
